{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Vision Hub{% endblock %} â€” Proceder</title>
    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Vision Hub Design System -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    {% block body %}
    <div class="d-flex min-vh-100">
        {% include "components/sidebar.html" %}
        <div class="flex-grow-1 vh-sidebar-offset d-flex flex-column min-vh-100">
            {% include "components/topbar.html" %}
            <main class="p-3 p-md-4 flex-grow-1 vh-animate-in">
                <div class="vh-page-wrapper">
                    {% if messages %}
                    <div class="mb-3">
                        {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} alert-dismissible fade show d-flex align-items-center gap-2" role="alert">
                            {% if message.tags == 'success' %}
                                <i class="bi bi-check-circle-fill flex-shrink-0"></i>
                            {% elif message.tags == 'danger' or message.tags == 'error' %}
                                <i class="bi bi-exclamation-triangle-fill flex-shrink-0"></i>
                            {% elif message.tags == 'warning' %}
                                <i class="bi bi-exclamation-circle-fill flex-shrink-0"></i>
                            {% else %}
                                <i class="bi bi-info-circle-fill flex-shrink-0"></i>
                            {% endif %}
                            <span>{{ message }}</span>
                            <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert"></button>
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}

                    {% block content %}{% endblock %}
                </div>
            </main>
        </div>
    </div>
    {% endblock %}
    <!-- Bootstrap 5.3 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Copy to clipboard
        function copyLink(inputId) {
            const input = document.getElementById(inputId);
            input.select();
            navigator.clipboard.writeText(input.value).then(() => {
                const btn = input.nextElementSibling;
                const originalText = btn.textContent;
                btn.textContent = 'Copiado!';
                setTimeout(() => btn.textContent = originalText, 2000);
            });
        }
        // Show/hide compartilhamento fields
        document.addEventListener('DOMContentLoaded', function() {
            const tipoSelect = document.getElementById('id_tipo_compartilhamento');
            if (tipoSelect) {
                function toggleFields() {
                    const val = tipoSelect.value;
                    const senhaGroup = document.getElementById('group-senha');
                    const expiraGroup = document.getElementById('group-expira');
                    if (senhaGroup) senhaGroup.style.display = val === 'protegido' ? 'block' : 'none';
                    if (expiraGroup) expiraGroup.style.display = val === 'temporario' ? 'block' : 'none';
                }
                tipoSelect.addEventListener('change', toggleFields);
                toggleFields();
            }
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
